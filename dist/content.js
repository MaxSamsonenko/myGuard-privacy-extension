function v(e,s){if(e.length===0)return s.length;if(s.length===0)return e.length;const n=[];for(let o=0;o<=s.length;o++)n[o]=[o];for(let o=0;o<=e.length;o++)n[0][o]=o;for(let o=1;o<=s.length;o++)for(let t=1;t<=e.length;t++)s.charAt(o-1)===e.charAt(t-1)?n[o][t]=n[o-1][t-1]:n[o][t]=Math.min(n[o-1][t-1]+1,n[o][t-1]+1,n[o-1][t]+1);return n[s.length][e.length]}function b(e){const s=document.createElement("style");s.textContent=`
		.myguard-threat-form {
			outline: 2px dashed red !important;
			background-color: rgba(255, 0, 0, 0.05) !important;
			transition: all 0.3s ease;
		}
	`,document.head.appendChild(s),e.forEach(n=>{const o=n.html.slice(0,100);document.querySelectorAll("form").forEach(t=>{t.outerHTML.includes(o)&&(t.classList.add("myguard-threat-form"),t.setAttribute("title",n.message))})})}function x(){const e=[];document.cookie&&document.cookie.length>0&&e.push("–°—Ç–æ—Ä—ñ–Ω–∫–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏–ª–∞ cookies ‚Äî –º–æ–∂–ª–∏–≤–æ –¥–ª—è –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è.");const s=["google-analytics.com","googletagmanager.com","facebook.net","hotjar.com","doubleclick.net","mixpanel.com","segment.io","cloudflareinsights.com"],n=Array.from(document.querySelectorAll("script[src]"));for(const o of n)s.some(t=>o.src.includes(t))&&e.push(`–í–∏—è–≤–ª–µ–Ω–æ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π —Ç—Ä–µ–∫–µ—Ä: ${o.src}`);return e}function A(){const e=[];document.querySelectorAll("input").forEach(n=>{typeof n.oninput=="function"&&e.push({message:"‚ö†Ô∏è –ü–æ–ª–µ –º–∞—î –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—É –æ–±—Ä–æ–±–∫—É –ø–æ–¥—ñ—ó oninput",html:n.outerHTML})});const s=Array.from(document.querySelectorAll("script")).map(n=>n.textContent||"").join(`
`);return(s.includes('.addEventListener("input"')||s.includes(".addEventListener('input'"))&&e.push({message:"‚ö†Ô∏è –í–∏—è–≤–ª–µ–Ω–æ –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è input –ø–æ–¥—ñ–π —É JS",html:'–°–∫—Ä–∏–ø—Ç –º—ñ—Å—Ç–∏—Ç—å .addEventListener("input")'}),document.querySelectorAll("script[src]").forEach(n=>{(n.getAttribute("src")||"").includes(location.hostname)||e.push({message:"‚ö†Ô∏è –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π —Å–∫—Ä–∏–ø—Ç (–∑–æ–≤–Ω—ñ—à–Ω—ñ–π src)",html:n.outerHTML})}),e}async function k(){const e=[];let s=[];const n=t=>{s.includes(t)||s.push(t)},o=EventTarget.prototype.addEventListener;return EventTarget.prototype.addEventListener=function(t,i,r){return["keydown","keypress","keyup"].includes(t)&&n(t),o.call(this,t,i,r)},["onkeydown","onkeypress","onkeyup"].forEach(t=>{[document,window].forEach(i=>{let r=null;Object.defineProperty(i,t,{set(c){const l=t.replace("on","");n(l),r=c},get(){return r},configurable:!0})})}),await new Promise(t=>setTimeout(t,1e3)),s.length>0&&e.push({message:"üõë –í–∏—è–≤–ª–µ–Ω–æ –ø—ñ–¥–æ–∑—Ä—É –Ω–∞ –∫–µ–π–ª–æ–≥–µ—Ä (–ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è –∫–ª–∞–≤—ñ—à)",html:`–°—Ç–æ—Ä—ñ–Ω–∫–∞ —Å–ª—É—Ö–∞—î –ø–æ–¥—ñ—ó: ${s.join(", ")}`}),e}function C(){const e=[];return Array.from(document.querySelectorAll("script:not([src])")).forEach((n,o)=>{var c;const t=(n.textContent||"").toLowerCase();let i=0,r=0;(t.includes("input.value")||t.includes(".value")||t.includes("textarea.value")||t.includes("select.value")||t.includes(".textcontent")||t.includes(".innertext"))&&i++,(t.includes("fetch(")||t.includes("xmlhttprequest")||t.includes("formdata")||t.includes(".send(")||t.includes("navigator.sendbeacon"))&&r++,i>0&&r>0&&e.push({message:`‚ö†Ô∏è –í–∏—è–≤–ª–µ–Ω–æ –º–æ–∂–ª–∏–≤–µ DOM-–∑—á–∏—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫—É –¥–∞–Ω–∏—Ö (—Å–∫—Ä–∏–ø—Ç ‚Ññ${o+1})`,html:((c=n.textContent)==null?void 0:c.slice(0,300))+"..."})}),e}function L(){const e=[],s=Array.from(document.querySelectorAll("script")).map(o=>o.textContent||"").join(`
`);return s.includes("getComputedStyle")&&s.includes(":visited")&&e.push({message:"‚ö†Ô∏è –ú–æ–∂–ª–∏–≤–∞ —Å–ø—Ä–æ–±–∞ –∑—á–∏—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∏–ª—ñ–≤ :visited –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —ñ—Å—Ç–æ—Ä—ñ—ó",html:"–°–∫—Ä–∏–ø—Ç –º—ñ—Å—Ç–∏—Ç—å –≤–∏–∫–ª–∏–∫ getComputedStyle + ':visited'"}),document.querySelectorAll("iframe").forEach(o=>{const t=o.getAttribute("src")||"",i=o.width&&Number(o.width)<5||o.height&&Number(o.height)<5;(t==="about:blank"||i)&&e.push({message:"‚ö†Ô∏è –í–∏—è–≤–ª–µ–Ω–æ iframe, —è–∫–∏–π –ø–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è sniffing-–∞—Ç–∞–∫–∏",html:o.outerHTML})}),Array.from(document.querySelectorAll("style")).map(o=>o.textContent||"").join(`
`).includes(":visited")&&e.push({message:"‚ö†Ô∏è CSS –º—ñ—Å—Ç–∏—Ç—å —Å–µ–ª–µ–∫—Ç–æ—Ä–∏ :visited ‚Äî –º–æ–∂–ª–∏–≤–µ –∑—á–∏—Ç—É–≤–∞–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó",html:":visited –≤ <style>"}),e}function T(){var s,n;const e=[];HTMLCanvasElement.prototype.toDataURL.toString().includes("[native code]")===!1&&(console.trace("üîç Fingerprinting triggered by: canvas.toDataURL"),e.push({message:"‚ö†Ô∏è –°–ø—Ä–æ–±–∞ –∑—á–∏—Ç–∞—Ç–∏ Canvas (toDataURL) ‚Äî –º–æ–∂–ª–∏–≤–∏–π canvas fingerprinting",html:"<canvas> –º–µ—Ç–æ–¥ toDataURL –±—É–≤ –∑–º—ñ–Ω–µ–Ω–∏–π"})),HTMLCanvasElement.prototype.getContext.toString().includes("[native code]")===!1&&(console.trace("üîç Fingerprinting triggered by: canvas.getContext"),e.push({message:"‚ö†Ô∏è Canvas getContext() –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ ‚Äî –º–æ–∂–ª–∏–≤–µ –∑—á–∏—Ç—É–≤–∞–Ω–Ω—è –≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö",html:"<canvas> –º–µ—Ç–æ–¥ getContext –±—É–≤ –∑–º—ñ–Ω–µ–Ω–∏–π"})),(typeof window.AudioContext<"u"||typeof window.webkitAudioContext<"u")&&(console.trace("üîç Fingerprinting triggered by: AudioContext"),e.push({message:"‚ö†Ô∏è –í–∏—è–≤–ª–µ–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è AudioContext ‚Äî –º–æ–∂–ª–∏–≤–µ –∞—É–¥—ñ–æ-—Ñ—ñ–Ω–≥–µ—Ä–ø—Ä–∏–Ω—Ç–∏–Ω–≥",html:"AudioContext –∞–±–æ webkitAudioContext –∞–∫—Ç–∏–≤–Ω–∏–π"}));try{const o=document.createElement("canvas");(o.getContext("webgl")||o.getContext("experimental-webgl"))&&(console.trace("üîç Fingerprinting triggered by: WebGL getContext"),e.push({message:"‚ö†Ô∏è –í–∏—è–≤–ª–µ–Ω–æ WebGL API ‚Äî –º–æ–∂–ª–∏–≤–∏–π WebGL fingerprinting",html:""}))}catch{}return(((s=navigator.plugins)==null?void 0:s.length)>0||((n=navigator.mimeTypes)==null?void 0:n.length)>0||"hardwareConcurrency"in navigator||"deviceMemory"in navigator)&&(console.trace("üîç Fingerprinting triggered by: navigator.hardwareConcurrency / deviceMemory / plugins"),e.push({message:"‚ö†Ô∏è –ó—á–∏—Ç—É—é—Ç—å—Å—è –¥–∞–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ ‚Äî –º–æ–∂–ª–∏–≤–∏–π hardware –∞–±–æ font fingerprinting",html:"navigator.plugins / hardwareConcurrency / deviceMemory"})),e}const E=[".ai","openai.com","anthropic.com","cohere.ai","character.ai","forefront.ai","poe.com","gptapi.io"];function u(e){return E.some(s=>e.includes(s))}function M(){const e=[];if(window.fetch){const t=window.fetch;window.fetch=function(...i){const[r,c]=i;try{const l=typeof(c==null?void 0:c.body)=="string"?c.body:JSON.stringify((c==null?void 0:c.body)||"");u(r)&&l.length>100&&e.push({message:"‚ö†Ô∏è –í–∏—è–≤–ª–µ–Ω–æ –ø–µ—Ä–µ–¥–∞—á—É –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ fetch",html:`fetch('${r}', {...})`})}catch{}return t.call(this,r,c)}}const s=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(t){try{const i=this._url||"";u(i)&&typeof t=="string"&&t.length>100&&e.push({message:"‚ö†Ô∏è –í–∏—è–≤–ª–µ–Ω–æ –ø–µ—Ä–µ–¥–∞—á—É –≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ XMLHttpRequest",html:`xhr.send(...) to ${i}`})}catch{}return s.call(this,t)};const n=navigator.sendBeacon;navigator.sendBeacon=function(t,i){try{const r=typeof i=="string"?i:"";u(t)&&r.length>100&&e.push({message:"‚ö†Ô∏è sendBeacon –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –≤–µ–ª–∏–∫—ñ –¥–∞–Ω—ñ –¥–æ AI-–¥–æ–º–µ–Ω—É",html:`navigator.sendBeacon('${t}', ...)`})}catch{}return n.call(this,t,i)};const o=window.WebSocket;return window.WebSocket=function(t,i){const r=i?new o(t,i):new o(t);return u(t)&&e.push({message:"‚ö†Ô∏è –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ WebSocket-–∑ º—î–¥–Ω–∞–Ω–Ω—è –∑ AI-–¥–æ–º–µ–Ω–æ–º",html:`new WebSocket("${t}")`}),r},document.querySelectorAll("iframe").forEach(t=>{const i=t.getAttribute("src")||"";u(i)&&e.push({message:"‚ö†Ô∏è –í–∏—è–≤–ª–µ–Ω–æ iframe –∑ AI-–¥–æ–º–µ–Ω—É",html:t.outerHTML.slice(0,200)+"..."})}),e}async function H(){const e=[],s=window.location.hostname.replace(/^www\./,""),n=s==="localhost"||s.endsWith(".localhost"),o=window.location.protocol==="https:"||n,t=document.querySelectorAll("form");let i=0;t.forEach(a=>{const h=a.querySelectorAll('input[type="email"], input[type="password"], input[name="token"], input[name="ssn"], input[name="card"], input[name="tel"], input[name="id"]'),g=a.getAttribute("action");!(g&&g.startsWith("https")||!g&&o)&&h.length>0&&e.push({message:"–§–æ—Ä–º–∞ –∑ —á—É—Ç–ª–∏–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏ –±–µ–∑ HTTPS-–∑–∞—Ö–∏—Å—Ç—É",html:a.outerHTML.slice(0,200)+"..."}),a.querySelectorAll('input[name*="token"], input[name*="ssn"], input[name*="id"], input[name*="card"]').length>0&&i++;const S=a.getAttribute("onsubmit");S&&/fetch|XMLHttpRequest/.test(S)&&e.push({message:"–§–æ—Ä–º–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î JavaScript –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ (onsubmit)",html:a.outerHTML.slice(0,200)+"..."})}),i>0&&e.push({message:`–í–∏—è–≤–ª–µ–Ω–æ ${i} —Ñ–æ—Ä–º(–∏) –∑ –ø—ñ–¥–æ–∑—Ä—ñ–ª–∏–º–∏ –ø–æ–ª—è–º–∏`,html:"–ú–æ–∂–ª–∏–≤–µ –∑–±–∏—Ä–∞–Ω–Ω—è –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö (token, ssn, id, card)."}),["facebook.com","google.com","paypal.com","amazon.com","apple.com","instagram.com","microsoft.com","netflix.com","linkedin.com","github.com","dropbox.com","bankofamerica.com"].forEach(a=>{const h=v(s,a);h>0&&h<=2&&e.push({message:`‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω–æ —Ñ—ñ—à–∏–Ω–≥–æ–≤–∏–π –¥–æ–º–µ–Ω: —Å—Ö–æ–∂–∏–π –Ω–∞ ${a}`,html:`–ü–æ—Ç–æ—á–Ω–∏–π –¥–æ–º–µ–Ω: ${s}`})}),(x()||[]).forEach(a=>e.push({message:a,html:document.documentElement.outerHTML.slice(0,200)+"..."}));const l=A();console.log("domthreats:",l),e.push(...l);const m=T();console.log("fingerprintingThreats:",m),e.push(...m);const p=await k();console.log("keyloggerThreats:",p),e.push(...p);const f=C();console.log("domHarvestingThreats:",f),e.push(...f);const y=L();console.log("historyLeaks:",y),e.push(...y);const w=M();console.log("aiThreats:",w),e.push(...w);const d={url:window.location.href,threats:e};return window.myGuardScanResult=d,chrome.runtime.sendMessage({type:"SAVE_SCAN_RESULT",payload:d}),chrome.runtime.sendMessage({type:"UPDATE_BADGE",payload:{threatCount:e.length}}),b(e),console.log("[myGuard] Scan complete:",d),d}function q(e){const s=e.threats.length===0,n=document.createElement("div");n.style.position="fixed",n.style.top="20px",n.style.right="20px",n.style.zIndex="9999",n.style.backgroundColor="#fff",n.style.padding="10px 15px",n.style.border="1px solid #ccc",n.style.borderRadius="8px",n.style.boxShadow="0 2px 8px rgba(0,0,0,0.15)",n.style.fontFamily="Arial, sans-serif",n.style.fontSize="14px";const o=document.createElement("p");o.textContent=s?"‚úÖ –ó–∞–≥—Ä–æ–∑ –Ω–µ –≤–∏—è–≤–ª–µ–Ω–æ":`‚ö†Ô∏è –í–∏—è–≤–ª–µ–Ω–æ ${e.threats.length} –∑–∞–≥—Ä–æ–∑(–∏)`,o.style.color=s?"green":"red",o.style.margin="0 0 8px 0",n.appendChild(o),document.body.appendChild(n),setTimeout(()=>{n.remove()},5e3)}function F(){chrome.runtime.onMessage.addListener((e,s,n)=>(e.type==="GET_SCAN_RESULT"&&(window.myGuardScanResult?n(window.myGuardScanResult):n({status:"pending"})),!0))}window.addEventListener("load",()=>{setTimeout(async()=>{const e=await H();q(e)},1e3)});F();
